<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <title>Brokerjs by echobnet</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>Brokerjs</h1>
        <h2>An internal application message bus with namespaces, wildcards, and more! Decouple those classes!</h2>

        <section id="downloads">
          <a href="https://github.com/echobnet/brokerjs/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/echobnet/brokerjs/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/echobnet/brokerjs" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1>
<a id="brokerjs-com" class="anchor" href="#brokerjs-com" aria-hidden="true"><span class="octicon octicon-link"></span></a>BrokerJS (.com)</h1>

<p><img src="https://codeship.com/projects/51834170-9606-0133-3125-3e79f15ecc1c/status?branch=master" alt="Build Status"></p>

<p><a href="http://brokerjs.com">BrokerJS</a> is an internal application message bus dedicated to decoupling classes, modules, and so on. It supports name spaces with wild-cards. It is fully documented and thoroughly tested. View documentation and examples <a href="http://brokerjs.com">here</a>.</p>

<h3>
<a id="version" class="anchor" href="#version" aria-hidden="true"><span class="octicon octicon-link"></span></a>Version</h3>

<p>0.5.1</p>

<h3>
<a id="tech" class="anchor" href="#tech" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tech</h3>

<p>BrokerJS runs on <a href="http://nodejs.org">NodeJS</a> <del>and in the browser</del>. It requires NodeJS 4.0.0 or greater (uses ECMA6).</p>

<h3>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h3>

<p>Node: </p>

<div class="highlight highlight-source-shell"><pre>$ npm install brokerjs --save</pre></div>

<h3>
<a id="usage-example-1-using-brokerjs-for-callbacks" class="anchor" href="#usage-example-1-using-brokerjs-for-callbacks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage Example 1: using brokerjs for "callbacks"</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-k">let</span> Broker <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>brokerjs<span class="pl-pds">'</span></span>);
<span class="pl-k">let</span> broker <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Broker</span>();

<span class="pl-c">// Some login controller:</span>
<span class="pl-k">function</span> <span class="pl-en">login</span>(<span class="pl-smi">name</span>, <span class="pl-smi">password</span>, <span class="pl-smi">callback</span>) {
    <span class="pl-smi">broker</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>login:for:<span class="pl-pds">'</span></span><span class="pl-k">+</span>name, <span class="pl-k">function</span>(<span class="pl-smi">e</span>) { 
        <span class="pl-smi">broker</span>.<span class="pl-en">off</span>(<span class="pl-smi">e</span>.<span class="pl-smi">subscription</span>.<span class="pl-smi">subId</span>);
        <span class="pl-en">callback</span>(<span class="pl-smi">e</span>.<span class="pl-c1">data</span>.<span class="pl-smi">result</span>);
    });
    <span class="pl-smi">broker</span>.<span class="pl-en">emit</span>(<span class="pl-s"><span class="pl-pds">'</span>auth:login<span class="pl-pds">'</span></span>, {name<span class="pl-k">:</span>name, pw<span class="pl-k">:</span>password, responseId<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>login:for:<span class="pl-pds">'</span></span><span class="pl-k">+</span>name});
}

<span class="pl-c">// Some auth module/class:</span>
<span class="pl-k">function</span> <span class="pl-en">constructor</span>() {
    <span class="pl-smi">broker</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>auth:login<span class="pl-pds">'</span></span>, (<span class="pl-smi">e</span>) <span class="pl-k">=&gt;</span> { <span class="pl-k">return</span> <span class="pl-v">this</span>.<span class="pl-en">onAuthLogin</span>(e); });
}
<span class="pl-k">function</span> <span class="pl-en">onAuthLogin</span>(<span class="pl-smi">event</span>) {
    <span class="pl-k">let</span> p <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Promise</span>((<span class="pl-smi">accept</span>,<span class="pl-smi">reject</span>) <span class="pl-k">=&gt;</span> {
        <span class="pl-c">// Do some async DB work, auth work, etc.</span>
        <span class="pl-k">let</span> result <span class="pl-k">=</span> <span class="pl-c1">true</span>; 
        <span class="pl-smi">broker</span>.<span class="pl-en">emit</span>(<span class="pl-smi">event</span>.<span class="pl-c1">data</span>.<span class="pl-smi">responseId</span>, {result<span class="pl-k">:</span> result, hash<span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>123abc<span class="pl-pds">'</span></span>});
        <span class="pl-en">accept</span>();
    });
    <span class="pl-k">return</span> p;
}</pre></div>

<p>Alternatively, you don't always need to return a promise, depending on how you want to use broker.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">onAuthLogin</span>(<span class="pl-smi">event</span>) {
    <span class="pl-c">// Do some async DB work, auth work, etc.</span>
    <span class="pl-k">let</span> result <span class="pl-k">=</span> <span class="pl-c1">true</span>; 
    <span class="pl-smi">broker</span>.<span class="pl-en">emit</span>(<span class="pl-smi">event</span>.<span class="pl-c1">data</span>.<span class="pl-smi">responseId</span>, {result<span class="pl-k">:</span> result, hash<span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>123abc<span class="pl-pds">'</span></span>});
}</pre></div>

<h3>
<a id="usage-example-2--channel-ids" class="anchor" href="#usage-example-2--channel-ids" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage Example 2: * channel ids</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">response</span>(<span class="pl-smi">e</span>) {
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-smi">e</span>.<span class="pl-smi">subscription</span>.<span class="pl-smi">channelId</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span> - <span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">e</span>.<span class="pl-c1">data</span>);
}

<span class="pl-smi">broker</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>*<span class="pl-pds">'</span></span>, response);
<span class="pl-smi">broker</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>app:*<span class="pl-pds">'</span></span>, response);
<span class="pl-smi">broker</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>app:init<span class="pl-pds">'</span></span>, response);
<span class="pl-smi">broker</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>app:control:shutdown<span class="pl-pds">'</span></span>, response);

<span class="pl-smi">broker</span>.<span class="pl-en">emit</span>(<span class="pl-s"><span class="pl-pds">'</span>app:control:shutdown<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Woot!<span class="pl-pds">'</span></span>);
<span class="pl-c">// displays: </span>
<span class="pl-c">//    app:control:shutdown - Woot!</span>
<span class="pl-c">//    app:* - Woot!</span>
<span class="pl-c">//    * - Woot!</span>

<span class="pl-smi">broker</span>.<span class="pl-en">emit</span>(<span class="pl-s"><span class="pl-pds">'</span>app:init:some:option<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Go for it!<span class="pl-pds">'</span></span>);
<span class="pl-c">// displays: </span>
<span class="pl-c">//    app:* - Go for it!</span>
<span class="pl-c">//    * - Go for it!</span>

<span class="pl-smi">broker</span>.<span class="pl-en">emit</span>(<span class="pl-s"><span class="pl-pds">'</span>app:init<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Init!<span class="pl-pds">'</span></span>);
<span class="pl-c">// displays: </span>
<span class="pl-c">//    app:init - Init!</span>
<span class="pl-c">//    app:* - Init!</span>
<span class="pl-c">//    * - Init!</span></pre></div>

<h3>
<a id="usage-example-3-priorities" class="anchor" href="#usage-example-3-priorities" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage Example 3: Priorities</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-k">let</span> <span class="pl-en">mycallback</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">e</span>) {
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>BOB<span class="pl-pds">'</span></span>);
};
<span class="pl-smi">broker</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>a:b<span class="pl-pds">'</span></span>, {priority<span class="pl-k">:</span><span class="pl-c1">100</span>}, mycallback);

<span class="pl-smi">broker</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>a:b<span class="pl-pds">'</span></span>, {priority<span class="pl-k">:</span><span class="pl-c1">2</span>}, <span class="pl-k">function</span>(<span class="pl-smi">e</span>) {
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>JACK<span class="pl-pds">'</span></span>);
});
<span class="pl-smi">broker</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>a:b<span class="pl-pds">'</span></span>, {priority<span class="pl-k">:</span><span class="pl-c1">5</span>}, <span class="pl-k">function</span>(<span class="pl-smi">e</span>) {
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>JIM<span class="pl-pds">'</span></span>);
});
<span class="pl-smi">broker</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>a:b<span class="pl-pds">'</span></span>, {priority<span class="pl-k">:</span><span class="pl-c1">3</span>}, <span class="pl-k">function</span>(<span class="pl-smi">e</span>) {
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>FIN<span class="pl-pds">'</span></span>);
});
<span class="pl-smi">broker</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>*<span class="pl-pds">'</span></span>, {priority<span class="pl-k">:</span><span class="pl-c1">1</span>}, <span class="pl-k">function</span>(<span class="pl-smi">e</span>) {
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>WHAAAAT?!<span class="pl-pds">'</span></span>);
});

<span class="pl-smi">broker</span>.<span class="pl-en">emit</span>(<span class="pl-s"><span class="pl-pds">'</span>a:b<span class="pl-pds">'</span></span>);
<span class="pl-c">// displays:</span>
<span class="pl-c">//    JACK</span>
<span class="pl-c">//    FIN</span>
<span class="pl-c">//    JIM</span>
<span class="pl-c">//    BOB</span>
<span class="pl-c">//    WHAAAAT?!</span>

<span class="pl-c">// OVERRIDING previous options</span>
<span class="pl-smi">broker</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>a:b<span class="pl-pds">'</span></span>, {priority<span class="pl-k">:</span><span class="pl-c1">1</span>}, mycallback);

<span class="pl-smi">broker</span>.<span class="pl-en">emit</span>(<span class="pl-s"><span class="pl-pds">'</span>a:b<span class="pl-pds">'</span></span>);
<span class="pl-c">// displays:</span>
<span class="pl-c">//    BOB</span>
<span class="pl-c">//    JACK</span>
<span class="pl-c">//    FIN</span>
<span class="pl-c">//    JIM</span>
<span class="pl-c">//    WHAAAAT?!</span></pre></div>

<h3>
<a id="todos" class="anchor" href="#todos" aria-hidden="true"><span class="octicon octicon-link"></span></a>Todos</h3>

<ul>
<li>Finish BrokerJS.com</li>
<li>Implement easy data return from emit.</li>
<li>Implement one-off subscription call and response helpers.</li>
<li>Implement two path response from subscribers.</li>
<li>Increase comment coverage</li>
</ul>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p>MIT</p>

<p><strong>Free Software!</strong></p>
      </section>
    </div>

    
  </body>
</html>
